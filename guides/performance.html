
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://crystal-lang.org/reference/guides/performance.html">
      
      <link rel="shortcut icon" href="https://crystal-lang.org/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>Performance - Crystal</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/style.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-42353458-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="blue">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#performance" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://crystal-lang.org/reference/" title="Crystal" class="md-header-nav__button md-logo" aria-label="Crystal">
      
  <img src="../assets/crystal-circ.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Crystal
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Performance
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/crystal-lang/crystal/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://crystal-lang.org/reference/" title="Crystal" class="md-nav__button md-logo" aria-label="Crystal">
      
  <img src="../assets/crystal-circ.svg" alt="logo">

    </a>
    Crystal
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/crystal-lang/crystal/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
    
    <label class="md-nav__link" for="nav-1">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Home
      </a>
    </label>
    <nav class="md-nav" aria-label="Home" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Home
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-1" type="checkbox" id="nav-1-1" >
    
    <label class="md-nav__link" for="nav-1-1">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../getting_started/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Getting started
      </a>
    </label>
    <nav class="md-nav" aria-label="Getting started" data-md-level="2">
      <label class="md-nav__title" for="nav-1-1">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../getting_started/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Getting started
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../getting_started/http_server.html" class="md-nav__link">
      An HTTP Server
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../getting_started/cli.html" class="md-nav__link">
      A Command Line Application
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../platform_support.html" class="md-nav__link">
      Platform Support
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3" >
    
    <label class="md-nav__link" for="nav-1-3">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../conventions/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Conventions
      </a>
    </label>
    <nav class="md-nav" aria-label="Conventions" data-md-level="2">
      <label class="md-nav__title" for="nav-1-3">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../conventions/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Conventions
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../conventions/coding_style.html" class="md-nav__link">
      Coding style
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../conventions/documenting_code.html" class="md-nav__link">
      Documenting code
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Language Reference
      </a>
    </label>
    <nav class="md-nav" aria-label="Language Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Language Reference
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/program.md" class="md-nav__link">
      Program
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/comments.html" class="md-nav__link">
      Comments
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" >
    
    <label class="md-nav__link" for="nav-2-3">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/literals/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Literals
      </a>
    </label>
    <nav class="md-nav" aria-label="Literals" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/literals/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Literals
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/nil.html" class="md-nav__link">
      Nil
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/bool.html" class="md-nav__link">
      Bool
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/integers.html" class="md-nav__link">
      Integers
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/floats.html" class="md-nav__link">
      Floats
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/char.html" class="md-nav__link">
      Char
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/string.html" class="md-nav__link">
      String
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/symbol.html" class="md-nav__link">
      Symbol
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/array.html" class="md-nav__link">
      Array
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/hash.html" class="md-nav__link">
      Hash
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/range.html" class="md-nav__link">
      Range
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/regex.html" class="md-nav__link">
      Regex
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/tuple.html" class="md-nav__link">
      Tuple
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/named_tuple.html" class="md-nav__link">
      NamedTuple
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/proc.html" class="md-nav__link">
      Proc
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/literals/command.html" class="md-nav__link">
      Command
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/assignment.html" class="md-nav__link">
      Assignment
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/local_variables.html" class="md-nav__link">
      Local variables
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6" >
    
    <label class="md-nav__link" for="nav-2-6">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/control_expressions.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Control expressions
      </a>
    </label>
    <nav class="md-nav" aria-label="Control expressions" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/control_expressions.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Control expressions
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/truthy_and_falsey_values.html" class="md-nav__link">
      Truthy and falsey values
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6-2" type="checkbox" id="nav-2-6-2" >
    
    <label class="md-nav__link" for="nav-2-6-2">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/if.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        if
      </a>
    </label>
    <nav class="md-nav" aria-label="if" data-md-level="3">
      <label class="md-nav__title" for="nav-2-6-2">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/if.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          if
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/as_a_suffix.html" class="md-nav__link">
      As a suffix
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/as_an_expression.html" class="md-nav__link">
      As an expression
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/ternary_if.html" class="md-nav__link">
      Ternary if
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/if_var.html" class="md-nav__link">
      if var
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/if_varis_a.html" class="md-nav__link">
      if var.is_a?(...)
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/if_varresponds_to.html" class="md-nav__link">
      if var.responds_to?(...)
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/if_var_nil.html" class="md-nav__link">
      if var.nil?
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/not.html" class="md-nav__link">
      if !
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/unless.html" class="md-nav__link">
      unless
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/case.html" class="md-nav__link">
      case
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6-5" type="checkbox" id="nav-2-6-5" >
    
    <label class="md-nav__link" for="nav-2-6-5">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/while.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        while
      </a>
    </label>
    <nav class="md-nav" aria-label="while" data-md-level="3">
      <label class="md-nav__title" for="nav-2-6-5">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/while.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          while
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/break.html" class="md-nav__link">
      break
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/next.html" class="md-nav__link">
      next
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/until.html" class="md-nav__link">
      until
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/and.html" class="md-nav__link">
      &&
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/or.html" class="md-nav__link">
      ||
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/requiring_files.html" class="md-nav__link">
      Requiring files
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8" >
    
    <label class="md-nav__link" for="nav-2-8">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/types_and_methods.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Types and methods
      </a>
    </label>
    <nav class="md-nav" aria-label="Types and methods" data-md-level="2">
      <label class="md-nav__title" for="nav-2-8">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/types_and_methods.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Types and methods
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/everything_is_an_object.html" class="md-nav__link">
      Everything is an object
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/the_program.html" class="md-nav__link">
      The Program
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-8-3" type="checkbox" id="nav-2-8-3" >
    
    <label class="md-nav__link" for="nav-2-8-3">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/classes_and_methods.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Classes and methods
      </a>
    </label>
    <nav class="md-nav" aria-label="Classes and methods" data-md-level="3">
      <label class="md-nav__title" for="nav-2-8-3">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/classes_and_methods.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Classes and methods
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/new%2C_initialize_and_allocate.html" class="md-nav__link">
      new, initialize and allocate
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/methods_and_instance_variables.html" class="md-nav__link">
      Methods and instance variables
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/type_inference.html" class="md-nav__link">
      Type inference
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/union_types.html" class="md-nav__link">
      Union types
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/overloading.html" class="md-nav__link">
      Overloading
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/default_and_named_arguments.html" class="md-nav__link">
      Default parameter values and named arguments
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/splats_and_tuples.html" class="md-nav__link">
      Splats and tuples
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/type_restrictions.html" class="md-nav__link">
      Type restrictions
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/return_types.html" class="md-nav__link">
      Return types
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/default_values_named_arguments_splats_tuples_and_overloading.html" class="md-nav__link">
      Method arguments
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/operators.html" class="md-nav__link">
      Operators
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/visibility.html" class="md-nav__link">
      Visibility
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-8-3-13" type="checkbox" id="nav-2-8-3-13" >
    
    <label class="md-nav__link" for="nav-2-8-3-13">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/inheritance.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Inheritance
      </a>
    </label>
    <nav class="md-nav" aria-label="Inheritance" data-md-level="4">
      <label class="md-nav__title" for="nav-2-8-3-13">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/inheritance.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Inheritance
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/virtual_and_abstract_types.html" class="md-nav__link">
      Virtual and abstract types
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/class_methods.html" class="md-nav__link">
      Class methods
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/class_variables.html" class="md-nav__link">
      Class variables
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/finalize.html" class="md-nav__link">
      finalize
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/modules.html" class="md-nav__link">
      Modules
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/generics.html" class="md-nav__link">
      Generics
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/structs.html" class="md-nav__link">
      Structs
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/constants.html" class="md-nav__link">
      Constants
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/enum.html" class="md-nav__link">
      Enums
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-8-9" type="checkbox" id="nav-2-8-9" >
    
    <label class="md-nav__link" for="nav-2-8-9">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/blocks_and_procs.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Blocks and Procs
      </a>
    </label>
    <nav class="md-nav" aria-label="Blocks and Procs" data-md-level="3">
      <label class="md-nav__title" for="nav-2-8-9">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/blocks_and_procs.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Blocks and Procs
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/capturing_blocks.html" class="md-nav__link">
      Capturing blocks
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/proc_literal.html" class="md-nav__link">
      Proc literal
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/block_forwarding.html" class="md-nav__link">
      Block forwarding
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/closures.html" class="md-nav__link">
      Closures
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/alias.html" class="md-nav__link">
      alias
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/exception_handling.html" class="md-nav__link">
      Exception handling
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/type_grammar.html" class="md-nav__link">
      Type grammar
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-11" type="checkbox" id="nav-2-11" >
    
    <label class="md-nav__link" for="nav-2-11">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/type_reflection.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Type reflection
      </a>
    </label>
    <nav class="md-nav" aria-label="Type reflection" data-md-level="2">
      <label class="md-nav__title" for="nav-2-11">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/type_reflection.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Type reflection
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/is_a.html" class="md-nav__link">
      is_a?
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/nil_question.html" class="md-nav__link">
      nil?
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/responds_to.html" class="md-nav__link">
      responds_to?
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/as.html" class="md-nav__link">
      as
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/as_question.html" class="md-nav__link">
      as?
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/typeof.html" class="md-nav__link">
      typeof
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-12" type="checkbox" id="nav-2-12" >
    
    <label class="md-nav__link" for="nav-2-12">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/macros/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Macros
      </a>
    </label>
    <nav class="md-nav" aria-label="Macros" data-md-level="2">
      <label class="md-nav__title" for="nav-2-12">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/macros/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Macros
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/macros/macro_methods.html" class="md-nav__link">
      Macro methods
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/macros/hooks.html" class="md-nav__link">
      Hooks
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/macros/fresh_variables.html" class="md-nav__link">
      Fresh variables
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-13" type="checkbox" id="nav-2-13" >
    
    <label class="md-nav__link" for="nav-2-13">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/annotations/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Annotations
      </a>
    </label>
    <nav class="md-nav" aria-label="Annotations" data-md-level="2">
      <label class="md-nav__title" for="nav-2-13">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/annotations/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Annotations
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/annotations/built_in_annotations.html" class="md-nav__link">
      Built-in annotations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-14" type="checkbox" id="nav-2-14" >
    
    <label class="md-nav__link" for="nav-2-14">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/low_level_primitives.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Low-level primitives
      </a>
    </label>
    <nav class="md-nav" aria-label="Low-level primitives" data-md-level="2">
      <label class="md-nav__title" for="nav-2-14">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/low_level_primitives.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Low-level primitives
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/pointerof.html" class="md-nav__link">
      pointerof
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/sizeof.html" class="md-nav__link">
      sizeof
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/instance_sizeof.html" class="md-nav__link">
      instance_sizeof
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/offsetof.html" class="md-nav__link">
      offsetof
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/declare_var.html" class="md-nav__link">
      Uninitialized variable declaration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-15" type="checkbox" id="nav-2-15" >
    
    <label class="md-nav__link" for="nav-2-15">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/compile_time_flags.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Compile-time flags
      </a>
    </label>
    <nav class="md-nav" aria-label="Compile-time flags" data-md-level="2">
      <label class="md-nav__title" for="nav-2-15">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/compile_time_flags.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Compile-time flags
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/cross-compilation.html" class="md-nav__link">
      Cross-compilation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-16" type="checkbox" id="nav-2-16" >
    
    <label class="md-nav__link" for="nav-2-16">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/c_bindings/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        C bindings
      </a>
    </label>
    <nav class="md-nav" aria-label="C bindings" data-md-level="2">
      <label class="md-nav__title" for="nav-2-16">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/c_bindings/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          C bindings
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/lib.html" class="md-nav__link">
      lib
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-16-2" type="checkbox" id="nav-2-16-2" >
    
    <label class="md-nav__link" for="nav-2-16-2">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../syntax_and_semantics/c_bindings/fun.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        fun
      </a>
    </label>
    <nav class="md-nav" aria-label="fun" data-md-level="3">
      <label class="md-nav__title" for="nav-2-16-2">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../syntax_and_semantics/c_bindings/fun.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          fun
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/out.html" class="md-nav__link">
      out
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/to_unsafe.html" class="md-nav__link">
      to_unsafe
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/struct.html" class="md-nav__link">
      struct
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/union.html" class="md-nav__link">
      union
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/enum.html" class="md-nav__link">
      enum
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/variables.html" class="md-nav__link">
      Variables
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/constants.html" class="md-nav__link">
      Constants
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/type.html" class="md-nav__link">
      type
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/alias.html" class="md-nav__link">
      alias
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/c_bindings/callbacks.html" class="md-nav__link">
      Callbacks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../syntax_and_semantics/unsafe.html" class="md-nav__link">
      Unsafe code
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      <span class="md-nav__icon md-icon"></span>
      
        Manuals
      
    </label>
    <nav class="md-nav" aria-label="Manuals" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        
          Manuals
        
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../using_the_compiler/index.html" class="md-nav__link">
      The Compiler
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
    
    <label class="md-nav__link" for="nav-3-2">
      <span class="md-nav__icon md-icon"></span>
      
        Shards
      
    </label>
    <nav class="md-nav" aria-label="Shards" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon"></span>
        
          Shards
        
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../the_shards_command/index.html" class="md-nav__link">
      shards manual
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Guides
      </a>
    </label>
    <nav class="md-nav" aria-label="Guides" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Guides
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="performance.html" class="md-nav__link md-nav__link--active"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Performance
        </a>
      </label>
    
    <a href="performance.html" class="md-nav__link md-nav__link--active">
      Performance
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#premature-optimization" class="md-nav__link">
    Premature optimization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avoiding-memory-allocations" class="md-nav__link">
    Avoiding memory allocations
  </a>
  
    <nav class="md-nav" aria-label="Avoiding memory allocations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dont-create-intermediate-strings-when-writing-to-an-io" class="md-nav__link">
    Don't create intermediate strings when writing to an IO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-string-interpolation-instead-of-concatenation" class="md-nav__link">
    Use string interpolation instead of concatenation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-io-allocation-for-string-building" class="md-nav__link">
    Avoid IO allocation for string building
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-creating-temporary-objects-over-and-over" class="md-nav__link">
    Avoid creating temporary objects over and over
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-structs-when-possible" class="md-nav__link">
    Use structs when possible
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iterating-strings" class="md-nav__link">
    Iterating strings
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="concurrency.html" class="md-nav__link">
      Concurrency
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="testing.html" class="md-nav__link">
      Testing
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" >
    
    <label class="md-nav__link" for="nav-4-4">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="writing_shards.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Writing Shards
      </a>
    </label>
    <nav class="md-nav" aria-label="Writing Shards" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="writing_shards.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Writing Shards
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="hosting/github.html" class="md-nav__link">
      Hosting on GitHub
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="hosting/gitlab.html" class="md-nav__link">
      Hosting on GitLab
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" >
    
    <label class="md-nav__link" for="nav-4-5">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="ci/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Continuous Integration
      </a>
    </label>
    <nav class="md-nav" aria-label="Continuous Integration" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="ci/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Continuous Integration
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="ci/travis.html" class="md-nav__link">
      Using Travis CI
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="ci/circleci.html" class="md-nav__link">
      Using CircleCI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="static_linking.html" class="md-nav__link">
      Static Linking
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7" >
    
    <label class="md-nav__link" for="nav-4-7">
      <span class="md-nav__icon md-icon"></span>
      
        <a href="../database/index.html" class="md-nav__link"
          style="margin: initial; padding: initial; pointer-events: initial">
      
        Database
      </a>
    </label>
    <nav class="md-nav" aria-label="Database" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        <span class="md-nav__icon md-icon"></span>
        
          <a href="../database/index.html" class="md-nav__link"
            style="margin: initial; padding: initial; pointer-events: initial">
        
          Database
        </a>
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../database/connection.html" class="md-nav__link">
      Connection
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../database/connection_pool.html" class="md-nav__link">
      Connection pool
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../database/transactions.html" class="md-nav__link">
      Transactions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../tutorials/README.md" class="md-nav__link">
      Tutorials
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#premature-optimization" class="md-nav__link">
    Premature optimization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avoiding-memory-allocations" class="md-nav__link">
    Avoiding memory allocations
  </a>
  
    <nav class="md-nav" aria-label="Avoiding memory allocations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dont-create-intermediate-strings-when-writing-to-an-io" class="md-nav__link">
    Don't create intermediate strings when writing to an IO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-string-interpolation-instead-of-concatenation" class="md-nav__link">
    Use string interpolation instead of concatenation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-io-allocation-for-string-building" class="md-nav__link">
    Avoid IO allocation for string building
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoid-creating-temporary-objects-over-and-over" class="md-nav__link">
    Avoid creating temporary objects over and over
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-structs-when-possible" class="md-nav__link">
    Use structs when possible
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iterating-strings" class="md-nav__link">
    Iterating strings
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/crystal-lang/crystal-book/tree/master/docs/guides/performance.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="performance">Performance<a class="headerlink" href="#performance" title="Permanent link">&para;</a></h1>
<p>Follow these tips to get the best out of your programs, both in speed and memory terms.</p>
<h2 id="premature-optimization">Premature optimization<a class="headerlink" href="#premature-optimization" title="Permanent link">&para;</a></h2>
<p>Donald Knuth once said:</p>
<blockquote>
<p>We should forget about small efficiencies, say about 97% of the time: premature optimization is the root of all evil. Yet we should not pass up our opportunities in that critical 3%.</p>
</blockquote>
<p>However, if you are writing a program and you realize that writing a semantically equivalent, faster version involves just minor changes, you shouldn't miss that opportunity.</p>
<p>And always be sure to profile your program to learn what its bottlenecks are. For profiling, on macOS you can use <a href="https://developer.apple.com/library/prerelease/content/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Instrument-TimeProfiler.html">Instruments Time Profiler</a>, which comes with XCode, or one of the <a href="https://stackoverflow.com/questions/11445619/profiling-c-on-mac-os-x">sampling profilers</a>. On Linux, any program that can profile C/C++ programs, like <a href="https://perf.wiki.kernel.org/index.php/Main_Page">perf</a> or <a href="http://valgrind.org/docs/manual/cl-manual.html">Callgrind</a>, should work.  For both Linux and OS X, you can detect most hotspots by running your program within a debugger then hitting "ctrl+c" to interrupt it occasionally and issuing a gdb <code>backtrace</code> command to look for patterns in backtraces (or use the <a href="https://poormansprofiler.org/">gdb poor man's profiler</a> which does the same thing for you, or OS X <code>sample</code> command.</p>
<p>Make sure to always profile programs by compiling or running them with the <code>--release</code> flag, which turns on optimizations.</p>
<h2 id="avoiding-memory-allocations">Avoiding memory allocations<a class="headerlink" href="#avoiding-memory-allocations" title="Permanent link">&para;</a></h2>
<p>One of the best optimizations you can do in a program is avoiding extra/useless memory allocation. A memory allocation happens when you create an instance of a <strong>class</strong>, which ends up allocating heap memory. Creating an instance of a <strong>struct</strong> uses stack memory and doesn't incur a performance penalty. If you don't know the difference between stack and heap memory, be sure to <a href="https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap">read this</a>.</p>
<p>Allocating heap memory is slow, and it puts more pressure on the Garbage Collector (GC) as it will later have to free that memory.</p>
<p>There are several ways to avoid heap memory allocations. The standard library is designed in a way to help you do that.</p>
<h3 id="dont-create-intermediate-strings-when-writing-to-an-io">Don't create intermediate strings when writing to an IO<a class="headerlink" href="#dont-create-intermediate-strings-when-writing-to-an-io" title="Permanent link">&para;</a></h3>
<p>To print a number to the standard output you write:</p>
<div class="highlight"><pre><span></span><code><span class="nb">puts</span> <span class="mi">123</span>
</code></pre></div>
<p>In many programming languages what will happen is that <code>to_s</code>, or a similar method for converting the object to its string representation, will be invoked, and then that string will be written to the standard output. This works, but it has a flaw: it creates an intermediate string, in heap memory, only to write it and then discard it. This, involves a heap memory allocation and gives a bit of work to the GC.</p>
<p>In Crystal, <code>puts</code> will invoke <code>to_s(io)</code> on the object, passing it the IO to which the string representation should be written.</p>
<p>So, you should never do this:</p>
<div class="highlight"><pre><span></span><code><span class="nb">puts</span> <span class="mi">123</span><span class="o">.</span><span class="n">to_s</span>
</code></pre></div>
<p>as it will create an intermediate string. Always append an object directly to an IO.</p>
<p>When writing custom types, always be sure to override <code>to_s(io)</code>, not <code>to_s</code>, and avoid creating intermediate strings in that method. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MyClass</span>
  <span class="c1"># Good</span>
  <span class="k">def</span> <span class="nf">to_s</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
    <span class="c1"># appends &quot;1, 2&quot; to IO without creating intermediate strings</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">io</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">y</span>
  <span class="k">end</span>

  <span class="c1"># Bad</span>
  <span class="k">def</span> <span class="nf">to_s</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="c1"># using a string interpolation creates an intermediate string.</span>
    <span class="c1"># this should be avoided</span>
    <span class="n">io</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>This philosophy of appending to an IO instead of returning an intermediate string results in better performance than handling intermediate strings. You should use this strategy in your API definitions too.</p>
<p>Let's compare the times:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># io_benchmark.cr</span>
<span class="k">require</span> <span class="s2">&quot;benchmark&quot;</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">IO</span><span class="o">::</span><span class="n">Memory</span><span class="o">.</span><span class="n">new</span>

<span class="n">Benchmark</span><span class="o">.</span><span class="n">ips</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;without to_s&quot;</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">io</span> <span class="o">&lt;&lt;</span> <span class="mi">123</span>
    <span class="n">io</span><span class="o">.</span><span class="n">clear</span>
  <span class="k">end</span>

  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;with to_s&quot;</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">io</span> <span class="o">&lt;&lt;</span> <span class="mi">123</span><span class="o">.</span><span class="n">to_s</span>
    <span class="n">io</span><span class="o">.</span><span class="n">clear</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>crystal run --release io_benchmark.cr
<span class="go">without to_s  77.11M ( 12.97ns) (± 1.05%)       fastest</span>
<span class="go">   with to_s  18.15M ( 55.09ns) (± 7.99%)  4.25× slower</span>
</code></pre></div>
<p>Always remember that it's not just the time that has improved: memory usage is also decreased.</p>
<h3 id="use-string-interpolation-instead-of-concatenation">Use string interpolation instead of concatenation<a class="headerlink" href="#use-string-interpolation-instead-of-concatenation" title="Permanent link">&para;</a></h3>
<p>Sometimes you need to work directly with strings built from combining string literals with other values. You shouldn't just concatenate these strings with <code>String#+(String)</code> but rather use <a href="../syntax_and_semantics/literals/string.html#interpolation">string interpolation</a> which allows to embed expressions into a string literal: <code>"Hello, #{name}"</code> is better than <code>"Hello, " +  name.to_s</code>.</p>
<p>Interpolated strings are transformed by the compiler to append to a string IO so that it automatically avoids intermediate strings. The example above translates to:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="o">.</span><span class="n">build</span> <span class="k">do</span> <span class="o">|</span><span class="n">io</span><span class="o">|</span>
  <span class="n">io</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Hello, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">name</span>
<span class="k">end</span>
</code></pre></div>
<h3 id="avoid-io-allocation-for-string-building">Avoid IO allocation for string building<a class="headerlink" href="#avoid-io-allocation-for-string-building" title="Permanent link">&para;</a></h3>
<p>Prefer to use the dedicated <code>String.build</code> optimized for building strings, instead of creating an intermediate <code>IO::Memory</code> allocation.</p>
<div class="highlight"><pre><span></span><code><span class="k">require</span> <span class="s2">&quot;benchmark&quot;</span>

<span class="n">Benchmark</span><span class="o">.</span><span class="n">ips</span> <span class="k">do</span> <span class="o">|</span><span class="n">bm</span><span class="o">|</span>
  <span class="n">bm</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;String.build&quot;</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">String</span><span class="o">.</span><span class="n">build</span> <span class="k">do</span> <span class="o">|</span><span class="n">io</span><span class="o">|</span>
      <span class="mi">99</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
        <span class="n">io</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;hello world&quot;</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">bm</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;IO::Memory&quot;</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">io</span> <span class="o">=</span> <span class="n">IO</span><span class="o">::</span><span class="n">Memory</span><span class="o">.</span><span class="n">new</span>
    <span class="mi">99</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
      <span class="n">io</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;hello world&quot;</span>
    <span class="k">end</span>
    <span class="n">io</span><span class="o">.</span><span class="n">to_s</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>crystal run --release str_benchmark.cr
<span class="go">String.build 597.57k (  1.67µs) (± 5.52%)       fastest</span>
<span class="go">  IO::Memory 423.82k (  2.36µs) (± 3.76%)  1.41× slower</span>
</code></pre></div>
<h3 id="avoid-creating-temporary-objects-over-and-over">Avoid creating temporary objects over and over<a class="headerlink" href="#avoid-creating-temporary-objects-over-and-over" title="Permanent link">&para;</a></h3>
<p>Consider this program:</p>
<div class="highlight"><pre><span></span><code><span class="n">lines_with_language_reference</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">line</span> <span class="o">=</span> <span class="nb">gets</span>
  <span class="k">if</span> <span class="o">[</span><span class="s2">&quot;crystal&quot;</span><span class="p">,</span> <span class="s2">&quot;ruby&quot;</span><span class="p">,</span> <span class="s2">&quot;java&quot;</span><span class="o">].</span><span class="n">any?</span> <span class="p">{</span> <span class="o">|</span><span class="n">string</span><span class="o">|</span> <span class="n">line</span><span class="o">.</span><span class="n">includes?</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">lines_with_language_reference</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="nb">puts</span> <span class="s2">&quot;Lines that mention crystal, ruby or java: </span><span class="si">#{</span><span class="n">lines_with_language_reference</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<p>The above program works but has a big performance problem: on every iteration a new array is created for <code>["crystal", "ruby", "java"]</code>. Remember: an array literal is just syntax sugar for creating an instance of an array and adding some values to it, and this will happen over and over on each iteration.</p>
<p>There are two ways to solve this:</p>
<ol>
<li>Use a tuple. If you use <code>{"crystal", "ruby", "java"}</code> in the above program it will work the same way, but since a tuple doesn't involve heap memory it will be faster, consume less memory, and give more chances for the compiler to optimize the program.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">lines_with_language_reference</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">line</span> <span class="o">=</span> <span class="nb">gets</span>
  <span class="k">if</span> <span class="p">{</span><span class="s2">&quot;crystal&quot;</span><span class="p">,</span> <span class="s2">&quot;ruby&quot;</span><span class="p">,</span> <span class="s2">&quot;java&quot;</span><span class="p">}</span><span class="o">.</span><span class="n">any?</span> <span class="p">{</span> <span class="o">|</span><span class="n">string</span><span class="o">|</span> <span class="n">line</span><span class="o">.</span><span class="n">includes?</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">lines_with_language_reference</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="nb">puts</span> <span class="s2">&quot;Lines that mention crystal, ruby or java: </span><span class="si">#{</span><span class="n">lines_with_language_reference</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<ol>
<li>Move the array to a constant.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="no">LANGS</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;crystal&quot;</span><span class="p">,</span> <span class="s2">&quot;ruby&quot;</span><span class="p">,</span> <span class="s2">&quot;java&quot;</span><span class="o">]</span>

<span class="n">lines_with_language_reference</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">line</span> <span class="o">=</span> <span class="nb">gets</span>
  <span class="k">if</span> <span class="n">LANGS</span><span class="o">.</span><span class="n">any?</span> <span class="p">{</span> <span class="o">|</span><span class="n">string</span><span class="o">|</span> <span class="n">line</span><span class="o">.</span><span class="n">includes?</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">lines_with_language_reference</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="nb">puts</span> <span class="s2">&quot;Lines that mention crystal, ruby or java: </span><span class="si">#{</span><span class="n">lines_with_language_reference</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<p>Using tuples is the preferred way.</p>
<p>Explicit array literals in loops is one way to create temporary objects, but these can also be created via method calls. For example <code>Hash#keys</code> will return a new array with the keys each time it's invoked. Instead of doing that, you can use <code>Hash#each_key</code>, <code>Hash#has_key?</code> and other methods.</p>
<h3 id="use-structs-when-possible">Use structs when possible<a class="headerlink" href="#use-structs-when-possible" title="Permanent link">&para;</a></h3>
<p>If you declare your type as a <strong>struct</strong> instead of a <strong>class</strong>, creating an instance of it will use stack memory, which is much cheaper than heap memory and doesn't put pressure on the GC.</p>
<p>You shouldn't always use a struct, though. Structs are passed by value, so if you pass one to a method and the method makes changes to it, the caller won't see those changes, so they can be bug-prone. The best thing to do is to only use structs with immutable objects, especially if they are small.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># class_vs_struct.cr</span>
<span class="k">require</span> <span class="s2">&quot;benchmark&quot;</span>

<span class="k">class</span> <span class="nc">PointClass</span>
  <span class="bp">getter</span> <span class="n">x</span>
  <span class="bp">getter</span> <span class="n">y</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="vi">@x</span> <span class="p">:</span> <span class="n">Int32</span><span class="p">,</span> <span class="vi">@y</span> <span class="p">:</span> <span class="n">Int32</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">struct</span> <span class="nc">PointStruct</span>
  <span class="bp">getter</span> <span class="n">x</span>
  <span class="bp">getter</span> <span class="n">y</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="vi">@x</span> <span class="p">:</span> <span class="n">Int32</span><span class="p">,</span> <span class="vi">@y</span> <span class="p">:</span> <span class="n">Int32</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">Benchmark</span><span class="o">.</span><span class="n">ips</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">PointClass</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;struct&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">PointStruct</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>crystal run --release class_vs_struct.cr
<span class="go"> class  28.17M (± 2.86%) 15.29× slower</span>
<span class="go">struct 430.82M (± 6.58%)       fastest</span>
</code></pre></div>
<h2 id="iterating-strings">Iterating strings<a class="headerlink" href="#iterating-strings" title="Permanent link">&para;</a></h2>
<p>Strings in Crystal always contain UTF-8 encoded bytes. UTF-8 is a variable-length encoding: a character may be represented by several bytes, although characters in the ASCII range are always represented by a single byte. Because of this, indexing a string with <code>String#[]</code> is not an <code>O(1)</code> operation, as the bytes need to be decoded each time to find the character at the given position. There's an optimization that Crystal's <code>String</code> does here: if it knows all the characters in the string are ASCII, then <code>String#[]</code> can be implemented in <code>O(1)</code>. However, this isn't generally true.</p>
<p>For this reason, iterating a String in this way is not optimal, and in fact has a complexity of <code>O(n^2)</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">string</span><span class="o">.</span><span class="n">size</span>
  <span class="n">char</span> <span class="o">=</span> <span class="n">string</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div>
<p>There's a second problem with the above: computing the <code>size</code> of a String is also slow, because it's not simply the number of bytes in the string (the <code>bytesize</code>). However, once a String's size has been computed, it is cached.</p>
<p>The way to improve performance in this case is to either use one of the iteration methods (<code>each_char</code>, <code>each_byte</code>, <code>each_codepoint</code>), or use the more low-level <code>Char::Reader</code> struct. For example, using <code>each_char</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span>
<span class="n">string</span><span class="o">.</span><span class="n">each_char</span> <span class="k">do</span> <span class="o">|</span><span class="n">char</span><span class="o">|</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="index.html" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Guides
              </div>
            </div>
          </a>
        
        
          <a href="concurrency.html" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Concurrency
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>